const init=()=>{if(document.querySelector("iframe")){notionIntegration();resizeIFrameToFitContent();window.addEventListener("resize",resizeIFrameToFitContent)}downloadButton()};function notionIntegration(){const iFrame=document.getElementById("article-body__iframe");const iFrameLinks=iFrame.contentWindow.document.getElementsByTagName("a");for(let i=0;i<iFrameLinks.length;i++){if(!iFrameLinks[i].classList.contains("table_of_contents-link")){iFrameLinks[i].setAttribute("target","_parent")}if(iFrameLinks[i].parentNode.classList.contains("source")){iFrameLinks[i].setAttribute("target","_blank")}}const sourceDivs=iFrame.contentWindow.document.querySelectorAll("div.source");const sourceDivsLength=sourceDivs.length;for(let i=0;i<sourceDivsLength;i++){const sourceUrlEl=sourceDivs[i].querySelector("a");if(!sourceUrlEl){const sourceUrl=sourceDivs[i].innerText;const sourceLink=document.createElement("a");sourceLink.setAttribute("href",sourceUrl);sourceLink.setAttribute("target","_blank");sourceLink.innerText=sourceUrl;sourceDivs[i].innerHTML="";sourceDivs[i].appendChild(sourceLink);continue}const sourceUrl=sourceUrlEl.getAttribute("href");const sourceIframe=document.createElement("iframe");sourceIframe.classList.add("source__iframe");sourceIframe.setAttribute("src",sourceUrl);sourceIframe.setAttribute("frameborder","0");sourceIframe.setAttribute("allowfullscreen","true");sourceIframe.setAttribute("allow","accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture");sourceIframe.style.width="100%";sourceIframe.style.height="30rem";sourceDivs[i].innerHTML="";sourceDivs[i].appendChild(sourceIframe)}const iFrameHead=iFrame.contentWindow.document.getElementsByTagName("head")[0];const notionFixStyle=document.createElement("link");notionFixStyle.setAttribute("rel","stylesheet");notionFixStyle.setAttribute("href","/stylesheets/notion-fixes.css");iFrameHead.appendChild(notionFixStyle)}function resizeIFrameToFitContent(){const iFrame=document.getElementById("article-body__iframe");iFrame.height=iFrame.contentWindow.document.body.scrollHeight+20}function downloadButton(){const downloadPopup=document.querySelector(".download-popup");const downloadPopupProgressBar=document.querySelector(".download-popup__progress-bar__fill");const donwloadButton=document.querySelector(".single-project__download");donwloadButton.addEventListener("click",e=>{const progressDuration=1500;downloadPopupProgressBar.style.width="0%";downloadPopupProgressBar.style.transition=`width ${progressDuration}ms linear`;downloadPopup.classList.add("active");setTimeout(()=>{downloadPopupProgressBar.style.width="100%"},100);setTimeout(()=>{downloadPopup.classList.remove("active")},progressDuration+500)})}window.addEventListener("load",init);